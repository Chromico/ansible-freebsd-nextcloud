---
# General vars including FreeBSD specific ansible tweaks
- hosts: nextcloud
  remote_user: ansible
  become: yes
  become_method: su
  gather_facts: False
  vars:
    ansible_python_interpreter: "/usr/local/bin/python"
  vars_files:
    - secrets/mysql.yml
  roles:
    - jail
    - pkg
    - mysql
    - nginx
    - redis
    - php

# Prepare the raw basics to get working
  pre_tasks:
  - name: Setup pkg directory
    file: path=/usr/local/etc/pkg/repos state=directory

  - name: Disable 'quarterly' pkg repo, use 'latest' instead
    copy:
      src: files/{{item}}
      dest: /usr/local/etc/pkg/repos/{{item}}
    with_items:
      - FreeBSD.conf
      - FreeBSD-latest.conf
